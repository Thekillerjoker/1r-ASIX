# Exercici 3: T√®cniques de rescat, recuperaci√≥ del sistema i fitxers de registre 
1. # Part 1: Windows 11
**Objectiu:**
*Investigar, provar i documentar diferents t√®cniques natives de Windows per a la restauraci√≥, recuperaci√≥ i diagnosi del sistema. Crea un document amb captures de pantalla i explica amb les teves paraules per a qu√® serveix cada eina o comanda que utilitzis.*
----
1. ## Preparaci√≥ de l‚Äôentorn:
1. ### Cerca com es pot crear un punt de restauraci√≥ del sistema:
  *El primer pas es obrir el panell de control amb Windows + R i escriure control.* 
  
  *Alla ens anaem a Sistema i seguretat i despr√®s a sistema i en sistema fem clcik en l'apartat de proteccio del sistema.*

  *Una vegada estem a Protecci√≥ del sistema ens apreixara unba finestra com aquesta:*

  ![Proteci√≥-Sistema](./Captures/pt-3/Crear-punt-restauracio.png)


- **Quins passos cal seguir?**
*Com es pot veure en l'imatge anterior ens diu el seg√ºent comentari:Para crear un punto de restauraci√≥n, habilite primero la protecci√≥n; para ello, selecione  una unidad y haga click en Configurar.*

*Aixo vol dir que per defecte Windos te deshabilitada la protecci√≥ del sitema que es la que ens permet desfer cambis no deseats revertint el sistema en un moment donat, per tant el primer pas es habilitar la protecci√≥ del equip.*

- **Primer pas:** 
  *Activar la protecci√≥ del sistema i seleccionar l'espai maxim en disc que s'utilitzara per a la protecci√≥ del sistema.*

  *Per fero farem clcik en l'opcio de Configurar, una vegada agim activat la proteccio dels sistema i configurat el espai al aplicar els cambis i tornar a l'apartat anterior s'esn desbloquejara l'opico de Crear un punt de restauracio.*

  ![Primer-pas-Punt-Restauracio](./Captures/pt-3/Punt-restauracio-3.png)

- **Segon Pas:**
  *Per crear el punt de restauraci√≥ nom√©s haurem de fer clcik en crear punt de restauraci√≥, ens demanaran que li posem un nom al punt de resturaci√≥ i despr√©s nom√©s hem de fer Crear i esperar a que finalitzi el procc√©s.*

  ![Creacio-Punt-Restauracio](./Captures/pt-3/Punt-restauracio-4.png)

  **En cas de tot haber anat correctament ens apareixara aquesta finestra:**

  ![Confirmacio-Punt-Restaruacio-Creat-Correctament](./Captures/pt-3/Punt-restauracio-5.png)

  
- **Com pots comprovar que s‚Äôha creat correctament?**
*Per poder comporbar si el punt de restauraci√≥ s'ha creat correctament, haurem de fer click en restaurar Sistema i ens apareixara una finestra informativa com aquesta:*

![Finestra-Informtaiva](./Captures/pt-3/Punt-restauracio-6.png)

*Haurem de fer click en seg√ºent i en la seg√ºent finestra si hem creat el punt correctament ens apaeixarar.*

![Demostracio-Creat-correctament](./Captures/pt-3/Punt-restauracio-7.png)


- **Explica amb les teves paraules per a qu√® serveixen els punts de restauraci√≥.**
*Un punt de restauraci√≥ √©s com una imatge dun punt del teu sistema en aquell moment, i la que permet desfer cambis fets en el sistema tornant aquell moment*

2. ### Explora el Registre d‚Äôesdeveniments de Windows:

- **On pots trobar-lo?**
  *Una de les maneres es cercant en el buscador visor*

  ![Visor-de-events](./Captures/pt-3/Visor-1.png)


- **Quines categories principals hi ha?**

![Categories-Visor-Events](./Captures/pt-3/Visor-categories.png)

*Com es pot verue a l'imatge hi han les seg√ºents categories:*
  1. **Vistas Personalitzades:** *S√≥n vistes guardades que combinen filltres (nivell, origen, Id, periode, equips) aplicats a diferents registres.* *Serveixen per poder revisar nomes els esdevdiments relevants per un diagnostic concret, com per exemple veure nom√©s els errors d'una aplicaico concreta.*
  2. **Registros de Windows:** *Es on es guarden tots els registres basic del propi sistema operatiu(Aplicaci√≥,Seguretat,Configuraci√≥,Sistema i els esdevediments renviats).* *Aquesta categoria es molt util ja que √©s on es trben la majoria de dels registres utils per diagnosticar errors del SO, i dels serveis del sistema.*
  3. **Registros de aplicaciones y servicios:** *Es on es troben els regustres especifics creats per aplicacions o serveis de Windows per exemple Microsoft-Windows-PowerShell.* *Aquesta categoria ess √∫til ja que proporciona infomraci√≥ detallada i centralitzada en components concrets; son la primera opci√≥ a mirar quan un servei o aplicaci√≥ falla.*
  4. **Suscripciones:** *√âs on est√° la configuraci√≥ per rebre esdevediments de altres equips en la xarxa.(Renviament de esdevediments).* *Aquestes configuraci√≥ns permeten centralitzar la monotoritzaci√≥ de varis equips en un unic visor d'esdevediments.*

- **Localitza i documenta tres errors recents del registre del Sistema:**
**Error: Kernel-EventTracing: error 0xC0000035:**
![Error-Esdevediment-1](./Captures/pt-3/Error-1.png)

**Explicaci√≥ del error:** *El missatje diu Error generado por Kernel-EventTracing que a sota ens diu "No se pudo iniciar sesion 'PerfDiag Logger' Error:0xC0000035".* *Aix√≤ indica que el sistema de trazat de events del Kernel (**Event Tracing for Windows ETW**) ha intentat arrancar una sesio anomenada PerfDiag Logger i ha fallat amb el codi 0xC0000035.*

**Que significa el codi 0xC0000035:**
- *El codi normalment representa **STATUS_OBJECT_NAME_COLLISION**, √©s ha dir una colisio de nom o objecte ja existent; en aquest context significa que la sesi√≥ ETW que s'intenta crear ja existeix o hi ha entrades duplicades relacionades mab aquesta sesi√≥.*

**Error 4625:**
![Error-4625](./Captures/pt-3/Error-2.png)

**Explicaci√≥ del error 4625:** *El missatje ens diu "Error de una cuenta al iniciar sesi√≥n.".*

*El esdevediment 4625 registra un intent d'inici de sesi√≥ fallit en Windows.*
**Explicaci√≥ de la informaci√≥ que ens dona:**
- **Origen:** *Microsoft Windows Security auditing ens indica que l'error prove del sistema d'auditoria de windows.*
- **Subjecte:** *Security id ens indica que es System, el nom de la conta es SRODRIGUEZBRAVO, i que el domini en aques cas com no te es WORKGROUP que vol dir que es el propi equip.*
- **Id. Inicio de session:** *0x3E7 es l'identificador utilitzat pel sistema que en aquest cas 0x3E7 es el compte SYSTEM en Windows.*
- **Tipus d'inici de sesi√≥ 2:** *Vol dir que es un tipus d'inici de sesi√≥ interactiu com per exemple amb el teclat en local.*
- **Cuenta con error de inicio de sesi√≥n : Null SID/ sergi/ SRODRIGUEZBRAO:** *Son dades de que el compte que ha intenta autentificarse i ha fallat; Null SID indica que no ha pogut resoldre un SID v√°lid per aquest compte.*
- **Categoria de tarea/ Palabras clave: Logon/Error de auditoria:** *Clasifica el esdevediment com relacionat amb l'inici de sesio i un error en l'auditoria.*
- **Equipo : SrodriguezBravo:** *√âs l'equip on s'ha prodogut l'intent.*
- **Fecha y hora:** *La data i la hora en que s'ha produgut l'error.*

**Error 8198:**
![Error-8198](./Captures/pt-3/Error-3.png)

**Explicaci√≥ del Error 8198:** *√âs un error d'activaci√≥ de llicencia registrat pel servei de Protecci√≥ de Software de Microsoft (**Software Protection Platalform, SPP**) quan slui.exe no ha pogut completar la activaci√≥ automatica.*
**Explicaci√≥ de la infomraci√≥ del error:**
- **Codi error 0x80040005:** *Aquest error sol ser un error generic de E_FAIL/ Acces fallit  o denegat en components de SPP, que indica que l'operacio d'activaci√≥ no s'ha completat, per un error generic(Problemes de permisos,comunicacio, serveis o archiu bloquejats).*
- **Argumentos en la linea de comandos:**
  - **Ruleid=1;Action=AutoActivate;Trigger=UserLogon;Sessionid=1:** *Indica que l'activacio automatica s'ha intentat al iniciar sesio d'usuari "Activar en background al logon".*
  - **AppId /SkuId:** *Identifiquen l'aplicaci√≥ i l'edicio del producte que s'intentava activar, per exemple un SKU de Windows.*
  - **NotificationInterval=1440:** *Sugereix intents programats cada 1440 minuts (1 dia).*
s
---
2. ## Exploraci√≥ del Registre de Windows :
1. ### Investiga com accedir a l‚ÄôEditor del Registre:
**Per accedir al editor del registre de Windos es pot entrar de diferents maneres:**
- *Cercant Editor del Registro al cercador de Windows i obrir-ho.*
- *Windows+alt+R i escribint el seg√ºent: regedit*

**Quins riscos comporta modificar-lo?**
*Al modificar el Registre de Windows canvia directament la "base de dades" que windows i moltes aplicaic√≥ns fan servir per emmagatzemar opcions i configuraci√≥ns; i una entrada mal editada o suprimida pot fer que els serveis no s'inic√Øn deixin de funcionar o el sistema es torni inutilitzable.*

**Riscos que et podries arribar a trobar:**
- *P√®rdua d'arrencada o pantalla blava.*
- *Aplicacions que deixen de funcionar, errors de permisos i perfils d'usuari.*
- *Configuracions de xarxa,seguretat o actualitzacions malament aplicades que provoquen errors dif√≠cils de reinvertir.*
- *I en el pitjor dels casos tenir que fer la reinstal¬∑laci√≥ del sistema si no tens una copia de seguretat previa.*

**Com pots exportar una c√≤pia de seguretat?**
*Per exportar una c√≤pia de seguretat de l'editor de registre has d'anar al menu d'arxiu, on t'apareixara un despelgable amb varies opcions una d'elles Exportar.*
![Exportar-Copia-Regedit](./Captures/pt-3/Regedit-exportar.png)

*El seg√∫ent pas √©s escollir el nom i on guardar la c√≤pia del registre de windows, √©s important revisar que √©s guardi amb extensio .reg*

![Exoportat-Rgedit-2](./Captures/pt-3/Regedit-exportar-2.png)

2. ### Explora diferents claus del registre.


**On pots trobar la informaci√≥ sobre el directori dels programes instal¬∑lats?**
*La informaci√≥ sobre el directori dels porgrames instal¬∑lats esta en:Equipo\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall.*

![Programes-Regedit](./Captures/pt-3/Programes-1.png)

**Demostraci√≥ que per exemple i ha informacio del programa de VirtualBox:**

![Programes-Rgedit-2](./Captures/pt-3/Programes-2.png)

**On es guarden les prefer√®ncies de l‚Äôusuari?**
*Les prefer√®ncies de l'usuari es guarden a : Equipo\HKEY_CURRENT_USER.*

![Regedit-Usuari](./Captures/pt-3/Configuracio-usuari.png)

- **Quina funci√≥ tenen les extensions de fitxers (com .txt) dins del registre?:**
*Tenen la funci√≥ d'indicar el tipus d'un fitxer i aixi permeten a windows coneixer que accions ha de oferir al usuari (Obrir,editar,etc..), que aplicaci√≥ utilitzar per defecte i quin icona mostrar en pantalla.*
---

3. ## Eines natives de recuperaci√≥:
   1. ### Cerca les opcions de recuperaci√≥ de Windows:

  - **Quines opcions hi ha dins ‚ÄúRecuperaci√≥‚Äù a la Configuraci√≥?**
  *Al apartat de Recuperaci√≥ a la Configuraci√≥ de windows hi ha quatre opcions:*√ß
    1. **Coregir problemes:** *Es la primera opci√≥ i √©s la que ens permet solucionar problemes del sistema sense haber de restablir l'equip i sense haver de tornar a una copia de seg√ºretat ja que alomillor no vols tornar a una versio anterior perque has fet canvis o apliacions noves o modificacions noves que vols mantenir i restaurar la copia de seguretat no te aquest canvis.*
    2. **Corretgir problemes amb Windows Update:** *Reinstalas la versio actual de windows des de l'ultima actualitzaci√≥ instalada i mantenint les aplicacions , archius i la configuraci√≥, aquesta es √∫til si l'error del problema pot ser una mala actualitzaci√≥ d'un controlador o que aquest problema es solucioni reinstalant les actualitzacions sense tocar aplicacions instalades,arxius i les cunfiguracions.*
    3. **Restablir l'equip:** *Et donara dues opcions a escollir, mantenir o eliminar els arxius personals,i despr√©s et reinstalara windows segons la teva opcio escollida, reinstalar mantenint els arxius o eliminant els arxius i reinstalntlo senser.*
    4. **Inici avan√ßat:** *Serveix per reiniciar el sistema i entrar en un menu avan√ßat on et deixa modificar la configuracio d'inici , iniciar d'es d'un altre disc o USB, entrar a la bios, cambiar la contrase√±a, obrir una consola de comandes per exemple per repara un disc o formategar , netegar, escanegar o escanegar un gestor d'arrencada trencat com un linux, entre altres opcions.* 

- **Quina difer√®ncia hi ha entre ‚ÄúRestablir aquest PC‚Äù i ‚ÄúInici avan√ßat‚Äù?**
  *La principal difer√®nica entre Restablir aquest PC i Inici avan√ßat √©s que amb restablir aquest PC reinstalas windows en el equip sense la necessitat d'un usb o disc extern, en canvi amb l'Inici avan√ßat el que fa es reiniciar l'equip i iniciar en el entorn de recuperaci√≥ de Windows tamb√© anomenat (WinRE) amb les opcions anomenades anteriorment: Reoaracio d'inici, restaruacio del sistema,la linea de comandes,recuperaci√≥ amb usb etc...*
![Sistema-Recuperaci√≥](./Captures/pt-3/Sistema-recuperacio.png)

2. ### Descobreix com accedir al men√∫ de recuperaci√≥.
**Per poder accedir al menu de recuperaci√≥ s'han de seguir els seg√ºents pasos:**
  1. *El primer pas √©s fer click en l'opcio de Reiniciar Ahora de l'opcio de Inicio Avanzado del sistema que √©s la manera m√©s rapida d'inicar al inici avan√ßat.*
   
 

  2. *El segon pas √©s una vegada hem entrat en inici avan√ßat ens hem de despla√ßar fins al menu anomenat Solucionar problemas.*
  ![Primer-Pas](./Captures/pt-3/Menu-recuperacio-1.png)
  3. *Una vegada hem entrat dins de solucionar problemas ens desplacem un espai i anem a Opciones Avanzadas:*
  ![Segon-Pas](./Captures/pt-3/Menu-recuperacio-2.png)
  4. *Una vegada hem entrat en Opciones avanzadas ja estem el men√∫ de recuperaci√≥*
   ![Tercer-Pas](./Captures/pt-3/Menu-recuperacio-3.png)

- **Quines opcions s‚Äôhi ofereixen?**
  *Hi ha les seg√ºents opci√≥ns:Reparaci√≥ dd'inici, Configuraci√≥ d'inici, S√≠mbol del sistema, Desinstalar les actualitzaci√≥ns, entrar en la configuracio de la bios UEFI,i per √∫ltim Restaurar el Sistema.*

- **Quina utilitat t√© l‚Äôopci√≥ ‚ÄúS√≠mbol del sistema‚Äù?**
  *Te l'utilitat de executar comandes per poder diagnosticar, reparar i executar accions que l'interficie grafica no pot fer cuan el sistema esta danyat o es inaccesible, i axi reparar el sistema.*

- **Investiga com s‚Äôutilitzen les comandes chkdsk, sfc i dism.**
*La comanda chdisk es fa servir per comprovar l'estructura del disc( el sistema d'arxius, sectors del disk, entrades etc...) i pot reparar sectors defectuosos i errors l√≤gics.*

*S'executa de la seg√ºent manera:*
```powershell
chkdsk C: /f /r
#L'opci√≥ /f repara els errors del sistema d'arxius; /r localitza sectors defectuosos i recupera informaci√≥ llegible;
```
*La comanda sfc serveix per analitzar tots els fitxers del sistema protegits i substitueix els que estiguin malmesos per versions correctes.*
```powershell
sfc /scannow
# la comanda scannow es la que li diu al sistema que l'escanegi ahra per trobar i corregir els arxius.
```
*Amb la comanda dism repara la imagte de windows i descarrega o empara fitxers d'origen per restaurar components trencats.*
```powershell
dism /online /cleanup-image /checkhealth
# Verifica si hi ha danys a l'imatge de windows sense realitzar escanegos profuns.
dism /online /cleanup-image /scanhealth
#Realitza un escaneig compet de l'imatge de windows en busca de corrupci√≥.
dism /online /cleanup-image /restorehealth
#Repara l'imatge de windows utilitzant arxius locals o descarregant-los des de windows update.
```
.
---

4. ## Gesti√≥ de serveis i processos
  1. ### Troba com es poden consultar i gestionar els serveis de Windows:
   **Hi ha diferents maneres de consultar els serveis de windows:**
      - **Amb l'eina gr√†fica "Services.msc":**
        - *La combinaci√≥ de tecles Win+R, i escriure services.msc i fer enter.*
      - **Amb el gestor de tasques:**
        - *Ctrl + shift + Esc -> pestanya **Serveis**.*
      - **Amb el cercador d'aplicacions:**
        - *Cercant **Serveis** en el cercador d'aplicacions de windows.*
- **Qu√® √©s exactament un servei?**
  *Un servei a Windows √©s un programa o proc√©s qeu s'executa en segon pla i que proporciona funcionalitaats esseencials al sistema operatiu o aplicacions sense necessitat d'interacci√≥ directa amb l'usuari.*

  *Alguns exemples de serveis s√≥n: Windows Update,Windows Defender etc.*

- **Quins serveis essencials pots trobar (com Windows Update o Firewall)?**
  **Administrador d'aplicacions:** *Processa les solicituds d'instalaci√≥, eliminaci√≥ i enumeraci√≥ per el software implementat a traves de la directiva de grup. √âs ah dir si √©s deshabilita aquest servei no podras instalar,eliminar ni modificar cap software implementat a traves de la directiva de grup.*

  ![Servei-Administracio-Aplicacions](./Captures/pt-3/Servei-1.png)

  **Client DNS:** *Un DNS √©s el que tradueix una URL a una IP i una IP a una URL el que fa que per anar ha una pagina web no t'hagis de sapiguer la direcio IP nom√©s la URL.* 
  *El serveid de client DNS, √©s el qeu s'encarrega de enviar consultes del sistema de noms de domini(DNS), i emmagatzema en catche els resultats de les consuletes i registre el nom complet del equip en la xarxa.*

  ![Client-DNS](./Captures/pt-3/Servei-2.png)

- **Com pots aturar o reiniciar un servei?**
  *Per aturar un servei el priemr que has de fer es fer click a sobre del servei que vols aturar i en la part esquerra de la llista de serveis si el servei esta actiu et donara l'opcio de aturar o reiniciar el servei.*

  ![Servei-DHCP](./Captures/pt-3/Servei-3.png)

  2. ### Explora el Gestor de tasques:√ß
   - **Quines pestanyes principals t√©?**
    *Les categories del gestor de tasques s√≥n:Processos, Rendiment, Historial d'aplicacions, Aplicacions d'arrencada, Usuaris, Detalls i Serveis.*
  ![Gestor-Tasques](./Captures/pt-3/Gestor-tareas-1.png)

  ![Rendiment](./Captures/pt-3/Rendiment.png)

  ![Historial-Aplicacions](./Captures/pt-3/Tareas-Historial.png)


  ![Aplicaciones](./Captures/pt-3/Tareas-Applicacions.png)

  ![Usuarios](./Captures/pt-3/Tareas-Usuario.png)


  ![Detalles](./Captures/pt-3/Tareas-Detalles.png)

  ![Servicios](./Captures/pt-3/Tareas-serveis.png)


- **Quina informaci√≥ pots obtenir de ‚ÄúRendiment‚Äù i ‚ÄúServeis‚Äù?**
  - **Informaci√≥ que pots obtenir de la pestanya de Rendiment:** *En la pestanya de Rendiment tens diferents subcategories amb informacio i un grafic de cada component de hardware, una categoria per CPU on tens informaci√≥ del model el seu us en %, la velocitat en ghz els processos i subprocesos actius, i un grafic amb el % us en 60 segons; aquesta informaci√≥ i grafic el tens repetit i es casi igual per les altres categories que son la memoria que es la RAM,  el discos durs, i les interfaces de xarxa separades les de ethernet i si en tens la de wifi, i tambe en un ordinador real tens el rendiment de les grafiques ja sigui integrada o externa, o les dos per exemple una RTX i la GPU del procesador; Per√≤ en la maquina virtual no apareix.*
  - **Informaci√≥ que pots obtenir de la pestanya de Serveis:** *En la pestanya de serveis pots obtenir una petita i rapida informaci√≥ dels serveis que s'estan o no executan en el sistema; Pots obtenir infomraci√≥ com el nom del servei,el PID(l'identificador del proc√©s asociat si el servei s'esta executant.), una breu descripcio de la funci√≥ del servei,l'estat del servei(si est√† actiu o inactiu), i Accions disponibles que son les seg√ºents:Iniciar,aturar o obrir serveis.msc.*
  - *I tot aix√≤ t'ho permet obtenir desde el propi gestor de tasques.*

- **Com pots controlar les aplicacions d‚Äôinici?**
*En la pestanya d'aplicacions d'inici al fer click sobre una aplicacio et permet si esta habilitada per que s'inici al engegar l'ordinador et permet deshabilitarla perqu√® no continui executanse al inici, i si esta deshabilitada et permet habilitar que s'inci.*  
---

5. ## Creaci√≥ d‚Äôeines de rescat
   1. ### Investiga com crear un disc o imatge de reparaci√≥ del sistema.
**El primer pas per crear una imatge de resrautaci√≥ √©s anar al panell de control, despr√©s a la categoria de Copias de Seg√ºretat i restauraci√≥:**

![1-Pas-Imatge-Restauracio](./Captures/pt-3/Crear-imagen-1.png)

*Una vegada estem en la pestanya de Copies de seg√ºretat i restauraci√≥ en la part esquerra sota de Ventana principal del panel de control hi ha dues opcions "Crear una imagen del sistema" i "Crear un disco de reparacion del sistema", nosaltres farem click sobre crear una imagen del sistema.*
*Una vegada hem fet click ens apareixara la seg√ºent finestra on a dalt de tot ens diu "D√≥nde desea guardar la copia de seguridad?" i ens fa una breu explicaci√≥ de que es una imatge de sistema; Ens dona tres opcions per seleccionar on volem guarda l'imatge del sistema: En un disc dur, en un o diversos DVDs, o en una unitat en xarxa, nosaltres escollirem en un disc dur i seg√ºent.*
![Crear-Imagen-2](./Captures/pt-3/Crear-imagen-2.png)

*Una vegada Hem seleccionat on volem guarda l'imatge del sistema el seg√∫ent pas es seleccionar quines partici√≥ns volem inclure en la imatge del sistema.*

![Crear-Imatge-2](./Captures/pt-3/Crear-imagen-3.png)

*El seguent √©s confirmar la configuraci√≥.*

![Crear-Imatge-3](./Captures/pt-3/Crear-imagen-4.png)

*Comprovem que s'hagi creat la carpeta amb l'imatge de la configuraci√≥.*

![Comprovacio-Imatge-Creada](./Captures/pt-3/Comprovacio-Imatge-restauracio.png)

- **Quina difer√®ncia hi ha entre un disc de reparaci√≥ i una imatge del sistema?**
*Un disc de reparaci√≥ √©s un eina d'arrencada amb eines per diagnosticar i reparar Windows l'arrencada, restaurar el sistema,CMD,per tant no cont√©la teva instalaci√≥ ni fitxers personals. En canvi una imatge del sistema √©s una copia exacta del disc(amb el Windows, els programes ,fitxers i la teva configuraci√≥).*

- **On es configuren les opcions d‚Äôhistorial de fitxers?**
*√âs configuren en el Panell de control -> Tots els Elements del panell de control -> Historial de fitxers.*
---
6. ## Proves i simulacions
1. ### Crea i modifica una clau de registre per fer proves.
  ```powershell
    New-Item -Path "HKCU:\Software\Prova" -Force
  ```
  ![Creacio d'una clau de registre](./Captures/pt-3/Clau-1.png)

  ```powershell
  New-ItemProperty -Path "HKCU:\Software\Prova" -Name "ProvaValor" -Value "Hola" -PropertyType String -Force
  #Amb la comanda indiquem el nom al arxhiu i el valr de dins per que sigui "Hola" i amb PropertyType String indiquem que sigui text.
  ```
  ![Clau-2](./Captures/pt-3/Clau-2.png)

- **Com pots exportar i restaurar una clau modificada?**
  *Per exportar una clau es fa amb la seg√ºent comanda:*
  ```powershell
  reg export "HKCU\Software\Prova" "$env:USERPROFILE\Desktop\Prova_Backup.reg" /y
  #Si s'ha exportat correctament ha de sortir el missatje La operaci√≥ s'ha completaat correctament.
  ```
  ![Exportar-Clau](./Captures/pt-3/Clau-3.png)

```powershell
#Per modificar el valor de la clau es fa de la sef√ºent manera:
Set-ItemProperty -Path "HKCU:\Software\Prova" -Name "ProvaValor" -Value "Modificat"
#Per revisar si la clau s'ha modificat correctament es fa de la seg√ºent manera:
Get-ItemProperty -Path "HKCU:\Software\Prova" 
```
![Modificar-Clau](./Captures/pt-3/Clau-8.png)

```powershell
#Per restaurar la clau al backup es fa de la seg√ºent manera:
reg import "$env:USERPROFILE\Desktop\Prova_Backup.reg"
#Despres revisem que la clau s'hagi restuarat:
Get-ItemProperty -Path "HKCU:\Software\Prova"
```

![Restaurar-Clau](./Captures/pt-3/Clau-9.png)


- **Qu√® passa si restaures un punt de restauraci√≥?**
*Que que tornes al mateix moment en el que vas fer el punt*

2. ### Explica com actuaries si el sistema no arrenca.
   *Intentaria entrar al inici avan√ßat ja sigui si m'inicia aut√≥maticament o sino tendria un usb d'arrencada, una vegada en el inici avan√ßat aniria a Solucionar problemes, despr√©s a opci√≥ns avan√ßades i simbol del sistema.*
   *Hi intentaria reparar els errors del sistema de fitxers amb la seguent comanda:*
   ```powershell
   chkdsk C: /f /r
   ```
*Despr√©s analitzaria tots els fitxers del sistema protegits i si hi ha alguns que estiguin malmesos els substituiria per versions correctes amb la seg√ºent comanda:*
```powershell
sfc /scannow
```
*ara repararia l'imatge de windows amb les seg√ºents comandes:*
```powershell
dism /online /cleanup-image /checkhealth

dism /online /cleanup-image /scanhealth

dism /online /cleanup-image /restorehealth

```
- **Quines opcions de rescat tens?**
*Tinc l'opcio de retaurar el sistema amb una imatge del sistema o amb un punt de resstauraci√≥*

- **Quin √∫s tindrien les eines com cmd o ‚ÄúInici avan√ßat‚Äù?**
*La d'analitzar el sistema en busqueda de errors i reparar-los i o restaurar el sistema.*
---

7. ## Q√ºestionari final
1. **Difer√®ncia entre punt de restauraci√≥ i imatge del sistema.?**
   
   *Amb una imatge del sistema recuperes tota l'informaci√≥ de l'ordinador √©s ha dir fas una imatge de tot el disc, en canvi amb un punt de restauraci√≥ recuperes nom√©s amb els elements m√©s importants de la configuraci√≥ del sistema en el moment que fas el punt.*
2. **Quines s√≥n les claus principals del registre de Windows?**
   
   *HKEY_CLASSES_ROOT: √âs on s'emagatzema l'informaci√≥ que garantiza que s'obri el programa correcte al obrir un arxiu, per exemple i obres un arxiu .docx s'obri el Word.*

   *HKEY_CURRENT_USER:Conte l'arrel de l'informaci√≥ de configuraci√≥ de l'usuari que ha iniciat sessi√≥ actualment, aquesta informaci√≥ conte: Les carpetes,colors de pantalla,configuraci√≥ del panell de control etc.*

   *HKEY_LOCAL_MACHINE: √âs on s'emagatzema l'informaci√≥ de la configuraci√≥ especifica de l'equip per qualsevol usuari.*

   *HKEY_USERS: √âs on √©stan tots els perfils d'usuari carregats actualment a l'equip.*

   *HKEY_CURRENT_CONFIG: √âs on s'emmagatzema l'informacio sobre el perfil de hardware que fa servir l'equip al iniciar el sistema.*

3. **Qu√® fa exactament la comanda sfc /scannow?**
   
   *Examina tots els arxius protegits del sistema i rempla√ßa els archius danyats per una copia emmagatzemada en cach√©, i una vegada a completat el proc√©s apareixen els resultats de l'examen.*

4. **Com pots accedir al men√∫ de recuperaci√≥ si Windows no inicia?**
   
   *Hi ha varies maneres d'accedir al men√∫ de recuperaci√≥:*

   **Autoamticament:** *Si Windows no s'inica correctament varies vegades, entrara automaticament al men√∫ de recuperaci√≥ (Windows RE).*
   **Configuraci√≥:** *En la configuracio de windows si vas a Sistema -> Recuperaci√≥ -> inici avan√ßat -> Reiniciar hara.*
   **Reinciant:** *Si mantens presionada la tecla Shift mentres selecciones "Inici/apagat > Reiniciar". al reiniciar entraras al men√∫ de restauraci√≥.*
   **Disc o USB de recuperaci√≥:** *Si tens un cd/dvd o usb de restauraci√≥ pots entrar.*
5. **Quina informaci√≥ pots obtenir del Registre d‚Äôesdeveniments?**
   
   *Pots obtenir els esdevediments del sistema, a la categoria de Registres de Windows conte els registres d'aplicaci√≥, seg√ºretat i sistema.*
.
---
---
 # üêß Part2: Ubuntu24:
**Objectiu:**
*Explorar i posar en pr√†ctica t√®cniques de manteniment, recuperaci√≥ i c√≤pia de seguretat en un sistema Linux basat en Ubuntu.*
# Part 2: Ubuntu 24:
**Objectius:**
- *Dominar les eines de recuperaci√≥ d'Ubuntu*
- *Explorar els fitxers de log i configuraci√≥ del sistema*
- *Practicar t√®cniques de rescat des de la l√≠nia de comandes*
- *Configurar c√≤pies de seguretat autom√†tiques*
.
---

1. ## Preparaci√≥ de l‚Äôentorn
1. ### Cerca com actualitzar el sistema i instal¬∑lar eines de recuperaci√≥:

- **Quines comandes s‚Äôutilitzen per actualitzar i instal¬∑lar paquets?**
```bash
#Comanda per actuar un paquet:
sudo apt-get update && sudo apt upgrade -y
#Comanda per instalar un paquet:
sudo apt-get install "nom-del-paquet"
```
  
- **Quines eines recomanaries per a c√≤pies de seguretat o recuperaci√≥? (ex.: Timeshift, Rsync, GParted‚Ä¶)**
  *Jo recomenaria si es per utilitzar en mode gr√†fic Timeshift per la seva sensilleza per crear i resturar una copia de seg√ºretat; Si √©s per utilitzar amb comandes des-de terminal o per exemple en un servidor utilitzaria Rsync.*

2. ### Investiga com crear un ‚Äúsnapshot‚Äù del sistema.

- **Qu√® √©s un snapshot?**
*Una snapshot √©s una instant√°nea del estat actual del sistema per fer una copia de seguretat d'una maquina localment o varies maquines a la vegada des d'una sola maquina*

- **Com pots llistar els snapshots existents?**
*Per llistar tots els snapshots creats amb Timeshift s'ha de fer la seg√ºent comandas:*
```bash
sudo timeshift --list
```

3. ### Explora l‚Äôestructura b√†sica del sistema.

- **Quins directoris hi ha a /?**
*Hi ha tots els direcitris del sistema:*

![Arrel](./Captures/pt-3/Linux/Arrel-1.png)

- **On es guarden els logs principals?**
*Els logs es guarden en el directori '/var/log'*
---
2. ## Logs i configuraci√≥ del sistema
1. ### Explora els fitxers de log al directori /var/log/.

- **Quina informaci√≥ hi contenen syslog, auth.log, kern.log i dpkg.log?**
 - **Syslog:** *Conte els missatges de arrencada i apagada del sistema,serveis que s'inicien o fallen,errors generals i avisos del sistema,missatges de programari i daemons.*
![Contingut-Syslog](./Captures/pt-3/Linux/Error-syslog.png)

  - **Auth.log:** *√âs el log d'autentificaci√≠ i seguretat;Conte la informaci√≥ sobre: Conexions SSH i tambe si han fallat,l'√∫s de 'sudo' i intents d'escalada de privilegis,autentificaci√≥ de serveis que utilitzen PAM(Pluggable Authentification Modules).*
![Contingut-Authlog](./Captures/pt-3/Linux/Fails-log.png)

  - **Kern.log:** *√âs el log del nucli de linux el Kernel;Cont√© informaci√≥ sobre: Drivers de hardware, errors i advert√®ncies del kernel, i esdevediments relacionats amb dispositius i controladors.*
  
  - **dpkg.log:** *Cont√© informacio sobre les instal¬∑lacions, actualitzacions i eliminacions de paquets gestionats per dpkg i per apt.*

- **Com pots llegir-los en temps real?**
*Per llegir-los en temps real s'ha d'executar la seg√∫ent comanda:*
```bash
tail -f /var/log/syslog
```
![Temps-Real](./Captures/pt-3/Linux/Logs-tempsreal.png)

2. ### Descobreix l‚Äôeina journalctl.

- **Com pots filtrar logs per servei, per temps o per nivell de prioritat?**
*Per filtrar logs per servei √©s fa amb la seg√ºent comanda:*
```bash
journalctl -u NetworkManager.service
```
![Filtre-Servei](./Captures/pt-3/Linux/Journalctl-serveis.png)

*Per filtrar Logs per Temps √©s fa amb la seg√ºent comanda:*
```bash
journalctl --since "-20min" until "now"
```
![Filtre-Temps](./Captures/pt-3/Linux/Journalctl-temps.png)

*Per filtrar Logs per nivell de prioritat √©s fa amb la seg√ºent comanda:*
```bash
journalctl -p err --since today
```
![Filtre-Prioritat](./Captures/pt-3/Linux/Journalctl-prioritat.png)

- **Quina difer√®ncia hi ha entre journalctl i els fitxers del directori /var/log/?**
*La principal difer√®ncia es que journalctl mostre els registres que emagatzema systemd-jounrald en format binari i permet fer consultes i filtrats potents; mentre que els fitxers de /var/log son fitxers de text pla escrits per syslog o aplicaicons que son m√©s llegibles i compatiblws amb eines tradicionals.*


3. ### Examina fitxers de configuraci√≥ importants.

- **Qu√® pots trobar a /etc/os-release, /etc/fstab, /etc/passwd o /etc/netplan/?**
*/etc/os-release √©s un fitxer de text que cont√© informaci√≥ sobre la distribuci√≥ Linux i la versi√≥ instalada;inclou el nom de la distribuci√≥, el nom curt, la descripci√≥ de la versi√≥ amb el nom de llan√ßament,l'ID de la versio,el nom en clau de la versi√≥, l'ID curt per a scripts,i enlla√ßos oficials (p√†gina principal, suport, informe d'errors,pol√≠tica de  privacitat etc.).*

![Os-Release](./Captures/pt-3/Linux/Os-release.png)

**/Etc/fstab/:** *fstab √©s un fitxer de text que especifica els dispositius i sistemes de fitxers que s'han de muntar autom√†ticament al'arrencada i les opcions de muntatge(filesystem,punt de muntatge, tipus, opcions, dump, pass).*

![FSTAB](./Captures/pt-3/Linux/fstab.png)

**/ETC/PASSWD/:** *Passwd √©s un fitxer de text que llista els comptes d'usuari del sistema. Cada l√≠nea conte set camps separats per dos punts: Username,placeholder de contrasenya, UID, GID, comentari, directroi home i shell per defecte.*

![Passwd](./Captures/pt-3/Linux/Passwd.png)

**/ETC/NETPLAN/:** *Netpanl √©s un directori amb dos arxius YAML que defineixen la configuraci√≥ de xarxa per a Netplan; El primer arxiu **01-network-manager-all.yaml:** indica que networkManager gestionar√† tots els dispositius, i **50-cloud-init.yaml:**defineix una interf√≠cie enp0s3 amb dhcp4:true es ha dir que et demanara una IPv4 via DHCP.*
![NETPLAN](./Captures/pt-3/Linux/Netplan-2.png)


- **Quina informaci√≥ proporcionen /proc/cpuinfo i /proc/meminfo?**
*Cpuinfo proporciona informaci√≥ detallada sobre el/els proecesador(s) detectats pel nucli com per exemple; el numer√≥ l√≤gic del processador,id del venedor, identificadors d'arquitectura i revisio del micrioprocesador, nom del model, versi√≥ del microcode, la freq√º√®nica , el tamany de la cache etc.*

![CPUINFO](./Captures/pt-3/Linux/CPUInfo.png)

*Meminfo proporciona informaci√≥ en temps real de l'estat de la mem√≤ria del sistema; cada l√≠nea √©s un camp amb un valor i una unitat normalment KB.Ens proporciona infomraci√≥ com:La mem√≤ria RAM total disponible per al sistema, mem√≤ria no utilitzada, mem√≤ria disponible per a noves aplicacions sense la necessitat de fer swap etc.*

![MemInfo](./Captures/pt-3/Linux/MemInfo.png)
---

3. ## Serveis i processos
1. ### Investiga com es gestionen els serveis amb systemctl.

- **Quines ordres permeten iniciar, aturar o habilitar serveis?**
```bash
#Per poder inicar un servei:
sudo systemctl start nomservei.service
#Per aturar un servei:
sudo systemctl stop nomservei.service
#Per Habilitar un servei:
sudo systemctl enable nomservei.service
#Per deshabilitar un servei:
sudo systemctl disable nomservei.service
```
- **Quins serveis essencials pots comprovar (ssh, NetworkManager, ufw...)?**
*Jo he comprovat NetworkManager:*

![NetwoekManager](./Captures/pt-3/Linux/Systemctl.png)

2. ### Analitza processos en execuci√≥.

- **Com pots veure llistats de processos i consum de recursos?**
*Per porde verue llistats de processos i consum de recursos es fa amb la comanda htop.*
```bash
#En cas de no tenir instalada htop:
sudo apt-get install htop
#Comanda per accedir a htop:
htop
```
![HTOP](./Captures/pt-3/Linux/Htop.png)

- **Quines difer√®ncies hi ha entre top, htop i ps?**
*La principal diferencia entre Top, Htop i Ps son les seg√ºents:*
- *Top √©s un monitor en temps real per veure el consum actual;*
- *Htop √©s un monitor en temps real per√≥ a diferencia de top √©s mes interactiu i m√©s facil de navegar i implementa colors i funcions avan√ßades.*
- *Per ultim PS √©s una llista est√†tica de processos per a sscripts i consultes puntuals.*

![Top](./Captures/pt-3/Linux/TOP.png)

![HTOP](./Captures/pt-3/Linux/Htop.png)

![ps](./Captures/pt-3/Linux/PSAux.png)

- **Qu√® mostra la comanda pstree?**
*Pstree mostra els processos del sistema organitzats en forma d'abre segons la relaci√≥ pare-fill; cada branca representa un proc√©s i els seus fills.*

![PSTREE](./Captures/pt-3/Linux/PSTree.png)
---
4. ## C√≤pies de seguretat
1. ## Cerca com utilitzar rsync per fer c√≤pies incrementals.

- **Quina √©s la seva sintaxi b√†sica?**
*La seva sintaxi b√†sica es rsync -a [opcions] origen/ desti/.*

*Jo he fet aquest exemple:*

![Rsync](./Captures/pt-3/Linux/Rsync.png)

- *Quins avantatges t√© sobre cp?*
*Rsync copia nom√©s els canvis,permet la sincornitzaci√≥ remota, amb --link-dest permet crear snapshots que semblen copies competes pero comparteixen en disc els arxius no modificats mitjan√ßant enlla√ßos, entre altres.*s

2. ### Apr√®n a crear i restaurar arxius comprimits amb tar.

- **Com pots llistar, crear i extreure arxius .tar.gz?**
*Per llistar un arxiu .tar.gz:*

![Llistar](./Captures/pt-3/Linux/Tar-2.png)

*Per crear un arxiu.tar.gz:*

![Crear](./Captures/pt-3/Linux/Tar.png)

*Per exportar arxius .tar.gz:*
![Exportar](./Captures/pt-3/Linux/Tar-3.png)

3. ### Opcional: Investiga com fer c√≤pies a nivell de bloc amb dd.
```bash
sudo dd if=/dev/sdX of=/dev/sdY bs=4M status=progress conv=fsync
# If= Dispositiu d'origen.
#Of= Destinaci√≥.
#bs=4M= Mida de bloc (per millorar el rendiment).
#status=progress= mostrar el progess en pantalla.
#conv=fsync= assegurar escrits a disc abans de finalitzar.
```
- **Quins riscos t√©?**
*Sobrescriptura irreversible,Consistencia de dades ja que clonar una partici√≥ o disc muntat pot produir una imatge incoherent,si hi ha sectors danyats dd els copiar√† tamn√© i la seg√ºretat ja que una imatge bit a bit cont√© totes les dades incloent les contrasenyes.*

- **En quins casos s‚Äôutilitza?**
*√âs sol utilitzar en clonaci√≥ de discs o particions per migracio de sistemes, creacio d'imatges completes de dispositius per copies de  seguretat exactes,creacio d'un USB/DVD arrencables, forense i recuperacio.*
---

1. ## Mode de recuperaci√≥ i Live USB
2. ### Com pots accedir al mode de recuperaci√≥ (GRUB Recovery Mode)?


Quines opcions ofereix el men√∫?


En quins casos utilitzaries fsck, dpkg o root shell?


2. ### Simula un escenari de rescat des d‚Äôun Live USB.


Quins passos cal seguir per muntar la partici√≥ del sistema i accedir-hi amb chroot?


Quines tasques pots fer un cop dins (reparar GRUB, reinstal¬∑lar paquets, restaurar c√≤pies...)?
---
6. ## Pr√†ctiques finals
1. ### Analitza els logs del sistema per detectar errors o intents d‚Äôintrusi√≥.


Troba intents de connexi√≥ fallits o errors del kernel recents.


Documenta la informaci√≥ obtinguda.


2. ### Simula un error i restaura un fitxer essencial.


Comprova que tot torna a funcionar.


Explica com podries haver evitat el problema amb una c√≤pia de seguretat.


3. ### Crea (o documenta com es crearia) un Live USB personalitzat amb eines de rescat.
d
----
7. ## Q√ºestionari final:
   Quina difer√®ncia hi ha entre rsync i cp?


Qu√® fa exactament la comanda fsck i quan no s‚Äôha d‚Äôutilitzar?


Qu√® √©s Timeshift i en qu√® millora les c√≤pies tradicionals?


Com pots restaurar el bootloader GRUB des d‚Äôun Live USB?


Quina difer√®ncia hi ha entre /var/log/syslog i journalctl?


Qu√® pots fer si oblides la contrasenya de root?
